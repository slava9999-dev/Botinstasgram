# üìù CHANGELOG

–í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ.

–§–æ—Ä–º–∞—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
–∏ –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è [Semantic Versioning](https://semver.org/lang/ru/).

---

## [2.2.1] - 2025-12-19

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï P0 –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø)

- **YooKassa Webhook Security (–î–í–£–•–£–†–û–í–ù–ï–í–ê–Ø –ó–ê–©–ò–¢–ê):**

  - üî¥ **–î–û–ë–ê–í–õ–ï–ù–û**: HMAC-SHA256 –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è webhook –ø–æ–¥–ø–∏—Å–∏
  - ‚úÖ IP-–ø—Ä–æ–≤–µ—Ä–∫–∞ + HMAC-–ø–æ–¥–ø–∏—Å—å = –¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-YooKassa-Signature` –µ—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
  - –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π logger
  - Graceful fallback –µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ (YooKassa –Ω–µ –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç)

- **Payment Rate Limiting:**
  - ‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û** –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Vercel KV
  - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
  - –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
  - ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã `console.error` –Ω–∞ `logger.error` –≤ `api/create-user/index.ts`
  - –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º JSON-—Ñ–æ—Ä–º–∞—Ç–µ
  - –£–ª—É—á—à–µ–Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –≤ production

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ URL:**
  - ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getBaseUrl()` –≤ `utils/constants.ts`
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: VERCEL_URL ‚Üí BASE_URL ‚Üí fallback
  - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ preview deployments
  - –£–±—Ä–∞–Ω—ã –≤—Å–µ hardcoded URL –∏–∑ –∫–æ–¥–∞
  - –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤: `webhook.ts`, `create.ts`, `bot/webhook.ts`

### üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `api/payment/webhook.ts` ‚Äî HMAC verification + getBaseUrl()
- `api/payment/create.ts` ‚Äî getBaseUrl()
- `api/bot/webhook.ts` ‚Äî getBaseUrl() + logger
- `api/create-user/index.ts` ‚Äî logger integration
- `utils/constants.ts` ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è getBaseUrl()

---

## [2.1.0] - 2025-12-16

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ

- **API Endpoints:**

  - `GET /api/users/:uuid/traffic` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¢–ó 4.3)
  - `GET /api/health` ‚Äî health check –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

- **–£—Ç–∏–ª–∏—Ç—ã:**

  - `utils/logger.ts` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–¢–ó —Ä–∞–∑–¥–µ–ª 9)
  - `utils/rate-limit.ts` ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏
  - `utils/payment-helpers.ts` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è env –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
  - `utils/constants.ts` ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
  - `ARCHITECTURE.md` ‚Äî –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  - `DEPLOYMENT.md` ‚Äî —á–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
  - `CHANGELOG.md` ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints:
  - `/api/payment/create`: 5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
  - `/api/create-user`: 10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç —á–µ—Ä–µ–∑ `Object.freeze()`

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JSON –ª–æ–≥–∏ –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π:
  - user_created, config_generated
  - panel_login_success/failed
  - payment_created/succeeded/failed
  - webhook_received/ignored
  - rate_limit_exceeded
  - traffic_checked

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ

- `package.json` ‚Äî –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `README.md` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω –¥–æ v2.1.0, –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- `api/payment/webhook.ts` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `axios`: ^1.6.0 ‚Üí 1.6.7 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
- `jsonwebtoken`: ^9.0.0 ‚Üí 9.0.2 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
- `uuid`: ^9.0.0 ‚Üí 9.0.1 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)
- `typescript`: ^5.0.0 ‚Üí 5.3.3 (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ)

---

## [2.0.0] - 2025-12-15

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ

- **–ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞**

- **API Endpoints:**

  - `POST /api/payment/create` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –≤ –ÆKassa
  - `POST /api/payment/webhook` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç –ÆKassa
  - `GET /api/payment/status` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
  - `POST /api/create-user` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ 3X-UI
  - `GET /api/config/:token` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ Xray JSON –∫–æ–Ω—Ñ–∏–≥–∞
  - `GET /api/link/:token` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ VLESS URI

- **Frontend:**

  - `index.html` ‚Äî landing page —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–ª–∞—Ç–µ–∂–µ–π
  - `test.html` ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - `success.html` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
  - `offer.html` ‚Äî –¥–æ–≥–æ–≤–æ—Ä –æ—Ñ–µ—Ä—Ç—ã
  - `privacy.html` ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏

- **–£—Ç–∏–ª–∏—Ç—ã:**

  - `utils/panel.ts` ‚Äî –∫–ª–∏–µ–Ω—Ç –¥–ª—è 3X-UI API
  - `utils/jwt.ts` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤
  - `utils/routing.json` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è Xray

- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

  - –ÆKassa ‚Äî –ø—Ä–∏—ë–º –ø–ª–∞—Ç–µ–∂–µ–π
  - 3X-UI ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ VPN –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
  - VLESS Reality ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π VPN –ø—Ä–æ—Ç–æ–∫–æ–ª

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
  - `README.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  - `TODO.md` ‚Äî —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ –∏ roadmap
  - `SPEC.md` ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
  - `.env.example` ‚Äî —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- Serverless –Ω–∞ Vercel
- Stateless JWT (–±–µ–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- TypeScript –¥–ª—è type safety
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ API

---

## [Unreleased]

### üéØ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

#### Phase 2: Persistent Storage

- [ ] Vercel KV –¥–ª—è rate limiting
- [ ] Vercel KV –¥–ª—è payment records
- [ ] PostgreSQL –¥–ª—è user analytics

#### Phase 3: Advanced Features

- [ ] Admin dashboard
- [ ] Real-time analytics
- [ ] Auto-renewal subscriptions
- [ ] Referral system
- [ ] Telegram bot integration

#### Phase 4: Testing

- [ ] Unit tests –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- [ ] Integration tests –¥–ª—è API endpoints
- [ ] E2E tests –¥–ª—è payment flow

#### Phase 5: Multi-region

- [ ] Multiple 3X-UI servers
- [ ] Geo-routing
- [ ] Load balancing

---

## –¢–∏–ø—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ** ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **üîß –ò–∑–º–µ–Ω–µ–Ω–æ** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ** ‚Äî —É–¥–∞–ª—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è/–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## –°—Å—ã–ª–∫–∏

- [GitHub Releases](https://github.com/slava9999-dev/Botinstasgram/releases)
- [Production](https://botinstasgram.vercel.app/)
- [Vercel Dashboard](https://vercel.com/dashboard)

---

**–§–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–π:** MAJOR.MINOR.PATCH

- **MAJOR** ‚Äî –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è API
- **MINOR** ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è)
- **PATCH** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤ (–æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ)
